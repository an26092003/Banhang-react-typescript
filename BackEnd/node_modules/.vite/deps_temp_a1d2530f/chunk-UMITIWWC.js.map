{
  "version": 3,
  "sources": ["../../cookie-signature/index.js"],
  "sourcesContent": ["/**\r\n * Module dependencies.\r\n */\r\n\r\nvar crypto = require('crypto');\r\n\r\n/**\r\n * Sign the given `val` with `secret`.\r\n *\r\n * @param {String} val\r\n * @param {String} secret\r\n * @return {String}\r\n * @api private\r\n */\r\n\r\nexports.sign = function(val, secret){\r\n  if ('string' != typeof val) throw new TypeError(\"Cookie value must be provided as a string.\");\r\n  if ('string' != typeof secret) throw new TypeError(\"Secret string must be provided.\");\r\n  return val + '.' + crypto\r\n    .createHmac('sha256', secret)\r\n    .update(val)\r\n    .digest('base64')\r\n    .replace(/\\=+$/, '');\r\n};\r\n\r\n/**\r\n * Unsign and decode the given `val` with `secret`,\r\n * returning `false` if the signature is invalid.\r\n *\r\n * @param {String} val\r\n * @param {String} secret\r\n * @return {String|Boolean}\r\n * @api private\r\n */\r\n\r\nexports.unsign = function(val, secret){\r\n  if ('string' != typeof val) throw new TypeError(\"Signed cookie string must be provided.\");\r\n  if ('string' != typeof secret) throw new TypeError(\"Secret string must be provided.\");\r\n  var str = val.slice(0, val.lastIndexOf('.'))\r\n    , mac = exports.sign(str, secret);\r\n  \r\n  return sha1(mac) == sha1(val) ? str : false;\r\n};\r\n\r\n/**\r\n * Private\r\n */\r\n\r\nfunction sha1(str){\r\n  return crypto.createHash('sha1').update(str).digest('hex');\r\n}\r\n"],
  "mappings": ";;;;;;;;AAAA;AAAA;AAIA,QAAI,SAAS;AAWb,YAAQ,OAAO,SAAS,KAAK,QAAO;AAClC,UAAI,YAAY,OAAO;AAAK,cAAM,IAAI,UAAU,4CAA4C;AAC5F,UAAI,YAAY,OAAO;AAAQ,cAAM,IAAI,UAAU,iCAAiC;AACpF,aAAO,MAAM,MAAM,OAChB,WAAW,UAAU,MAAM,EAC3B,OAAO,GAAG,EACV,OAAO,QAAQ,EACf,QAAQ,QAAQ,EAAE;AAAA,IACvB;AAYA,YAAQ,SAAS,SAAS,KAAK,QAAO;AACpC,UAAI,YAAY,OAAO;AAAK,cAAM,IAAI,UAAU,wCAAwC;AACxF,UAAI,YAAY,OAAO;AAAQ,cAAM,IAAI,UAAU,iCAAiC;AACpF,UAAI,MAAM,IAAI,MAAM,GAAG,IAAI,YAAY,GAAG,CAAC,GACvC,MAAM,QAAQ,KAAK,KAAK,MAAM;AAElC,aAAO,KAAK,GAAG,KAAK,KAAK,GAAG,IAAI,MAAM;AAAA,IACxC;AAMA,aAAS,KAAK,KAAI;AAChB,aAAO,OAAO,WAAW,MAAM,EAAE,OAAO,GAAG,EAAE,OAAO,KAAK;AAAA,IAC3D;AAAA;AAAA;",
  "names": []
}
